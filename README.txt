DCF_Renamer.exe (Windows10/64bit）Ver 1.1.0 について
			2021/07/18、改 2025/09/25
			Masahiro Terada

＜概要＞
撮影画像ファイルの入ったフォルダに対して
撮影日時をファイル名文字列にして一括でリネームします。
例）DSCF0001.JPG  => YYYY_MMDD_hhmm-ss.JPG

＜制約＞
このツールは個人的な日常ニーズにフィットさせた簡易実装です。
・モード切替えなどのオプションはなし
・汎用的なツールへのアップデート予定なし
・使用によって生じた不都合に関して一切責任を負いません
をご了承ください。

＜履歴＞
旧版からの変更点は以下の通りですのでご注意下さい。
v1.0）
・引数で渡せるフォルダが１つだけ、複数渡すときは全てファイル名のみ、フォルダのサブフォルダは処理されない。
・渡したフォルダは配下の最も日付数字の小さい（古い）ファイルの先頭９文字（YYYY_MMDD）にリネームされる。
・引数を省略すると起動方法（コマンドライン）を表示して終了する。
v1.1）
・フォルダとファイル名の混在可、フォルダは下位階層まで全て処理する。
・フォルダは直下の最も日付数字の小さい（古い）ファイルの先頭９文字（YYYY_MMDD）にリネームされる。
・引数を省略すると（確認ダイアログを経て）リムーバブルメディアをサーチし、
　　DCFフォルダ（100_FUJI, 101_FUJI等）を自動的にデスクトップにコピーして一括リネームを実行し、
　　リネーム後に（確認ダイアログを経て）対象のリムーバブルドライブの取り外し※処理を行う。
　　※外部コマンドとして RemoveDrive.exe を使用します。パスの通ったフォルダにない場合は、
　　　取り外しは行われず、OSの手動操作で取り外しを行うようメッセージボックスを表示します。
・アイコンやバージョンリソースを追加しました。

ーーーーーーーーーーーーーーーーーーーーーー
使い方
ーーーーーーーーーーーーーーーーーーーーーー
１．引数でフォルダやファイルを指定する
usage> Renamer.exe   ファイル名もしくはフォルダ名　ファイル名もしくはフォルダ名　．．．

DCF_Renamer（のショートカット）に画像ファイル、画像フォルダ、もしくはその混在をドロップする。

（１）ファイル名
　Exif JPEG は DateTimeOriginalタグの情報をもとにして
　"YYYY_MMDD_hhmm-ss.拡張子" 形式の名称にリネームします。
　ExifのないJPEGおよび下記（３）対象範囲のRAWや動画ファイルはすべて、
　個別のタグは解析せずファイルのタイムスタンプ情報でリネームします。

 【特別ルール 】
　時刻が深夜の2:00までは前日とみなす「みなし日時文字列」を付与します。
　2021年7月19日の深夜1時59分は、
　2021_0719_0159  ではなく 2021_0718_2559 （前日の25時台）になります。
　なお、年末年始をまたいでも同様になる点にご注意ください。

（２）フォルダ名
　指定したフォルダとそのツリー下のすべてのフォルダとファイルが対象となります。
　フォルダはそのフォルダ直下の対象ファイルの年月日が最も若い名前の先頭９文字でリネームします。
　例）2021_0712

（３）対象範囲
　リネームの対象となる拡張子は jpg,mov,avi,mp4,tif,raf,nef,cr2,arw のみ。
　その他の拡張子のファイルはリネームしません。
　但し、例外ケースがあります。
　フォルダの指定を経由して引き当てられたファイルは全て上記拡張子のみが対象となりますが、
　コマンド引数に直接与えたファイル名だけは、拡張子に関係なくリネームします。

（４）重複処理
　既に同名ファイルがある、時分秒が重複する（連写等）場合は、
　後発のファイルは末尾に(1),(2)...が付加されます。
　新しいファイル名と元のファイル名が同じ場合は変化なし。
　フォルダも同一階層に同名が既にあれば末尾に(1),(2)...が付加されます。

（５）留意点
　リネームしようとするファイルが使用中だとエラーで停止します。
　フォルダ内にあるリネーム対象外のファイルが使用中であってもフォルダのリネームでエラーになるので注意してください。
　エクスプローラーのUndoではリネーム前の状態には戻せません。
　⇒　意図に合致しているか、試用して確認してください。

２．引数なしで起動する

リムーバブルドライブのメディアからDCFフォルダを自動取り込みするか確認ダイアログが出ます。
OKすると以下を実行します。

（１）DCFフォルダをすべてデスクトップにコピーする
　メディアの \DCIM\100_FUJI、\DCIM\101_FUJI などデジタルカメラが画像を記録するフォルダです。

（２）上記コピーしたフォルダを対象にリネーム処理を実行する。

（３）リネームが終了するとDCFフォルダのあるリムーバブルドライブを自動的に取り外し処理します。
　　（取り外すかどうか確認ダイアログが出ます）

（４）留意点
　DCFフォルダ以外のフォルダはコピーされません。
　取り外し処理には、パスの通った場所に RemoveDrive.exe が置かれている必要があります。
　取り外し前にメディアのファイルの削除はしません。コピー後にオリジナルが不要な場合は自分で削除してください。

以上です。
